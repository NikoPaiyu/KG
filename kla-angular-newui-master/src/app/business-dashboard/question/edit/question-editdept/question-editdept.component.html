<div class="row">
  <div class="col-md-12 col-sm-12 mb-2">
    <nz-breadcrumb>
      <nz-breadcrumb-item [routerLink]="
          isMLA()
            ? ['/business-dashboard/question/question-dashboard']
            : ['/business-dashboard/question/question-dept-dashboard']
        ">
        {{ "business-dashboard.question.dashboard" | translate }}
      </nz-breadcrumb-item>
      <nz-breadcrumb-item>
        {{ "business-dashboard.question.notice" | translate }}
      </nz-breadcrumb-item>
    </nz-breadcrumb>
  </div>
</div>

<div class="row d-flex justify-content-between" *ngIf="qDetail && buttonlist">
  <div class="col-md-12">
    <h2 class="admin-page-heading">
      {{ "business-dashboard.question.noticeforquestion" | translate }}
    </h2>
  </div>
</div>
<div class="sticky_action_bar">
<div class="row">
  <div class="col-md-12">
    <div class="row">
      <div class="col-md-4 col-sm-12 pr-0">
        <button nz-button nzType="default" class="mr-5" (click)="showFileInfoPopUp(true)">
          {{"business-dashboard.question.noticeinfo" | translate}}
        </button>
        <button *ngIf="buttonlist.notes || buttonlist.version" nz-button nzType="primary" class="fix-btn"
          (click)="handleNotes(true)">
          {{ "business-dashboard.question.notes" | translate }}({{
            notesList.length
          }})
        </button>
        <button class="mr-5" *ngIf="buttonlist.version" nz-button (click)="showVersion()">
          {{ "business-dashboard.question.versions" | translate }}
        </button>
        <button *ngIf="buttonlist.checkDuplicate" class="mr-15" nz-button (click)="getQuestionDuplication()">
          {{ "business-dashboard.question.checkduplicate" | translate }}
        </button>
      </div>
      <div class="col-md-8 col-sm-12 d-flex btn-sec">
        <div class="d-flex">
          <button nz-button nzType="primary" *ngIf="buttonlist.Back" [routerLink]="[
              '/business-dashboard/question/question-view',
              qDetail.question.id,
              statusParam
            ]" style="margin-left: 6px;">
            {{"business-dashboard.question.questionview.back" | translate}}
          </button>
          <button *ngIf="buttonlist.Draft && buttonlist.Revoke == false" nz-button nzType="primary"
            (click)="saveAsDraft()" style="margin-left: 6px;">
            {{ "business-dashboard.question.save" | translate }}
          </button>
          <button nz-button nzType="primary" *ngIf="buttonlist.Approve" nz-popconfirm nzCancelText="No" nzOkText="Yes"
            nzPopconfirmTitle='{{"business-dashboard.question.douwantadmitthisNotice" | translate}}' (nzOnConfirm)="admitQuestion()"
            nzPopconfirmPlacement="bottomLeft" style="margin-left: 6px;">
            {{"business-dashboard.question.admit" | translate}}
          </button>
          <button nz-button nzType="primary" *ngIf="buttonlist.Disallow" nz-popconfirm nzCancelText="No" nzOkText="Yes"
            nzPopconfirmTitle='{{"business-dashboard.question.douwantdisallowthisNotice" | translate}}' (nzOnConfirm)="DisallowQuestion()"
            nzPopconfirmPlacement="bottomLeft" style="margin-left: 6px;">
            {{"business-dashboard.question.questionlist.disallow" | translate}}
          </button>
        </div>
        <nz-select *ngIf="buttonlist.ForwardTo" name="forward" class="col-md-5" nzPlaceHolder='{{"dashboard.seatlayout.select" | translate}}'
          [(ngModel)]="forwardToQS" (ngModelChange)="forwardNoticeTo($event)">
          <nz-option *ngFor="let data of forwardTo" [nzLabel]="data.displayName" [nzValue]="data">
          </nz-option>
        </nz-select>
        <button nz-button nzType="primary" *ngIf="buttonlist.ForwardTo" nz-popconfirm nzCancelText="No" nzOkText="Yes"
          nzPopconfirmTitle='{{"business-dashboard.question.areyousureyouwantto" | translate}} {{ ForwardButton }}? ' (nzOnConfirm)="forwardToQuestion()"
          nzPopconfirmPlacement="bottomLeft" style="margin-left: 6px;">
          {{ ForwardButton }}
        </button>
        <button nz-button nzType="primary"
          *ngIf="editableFields.transferDate && qDetail.question.type !== 'SHORT_NOTICE'"
          (click)="_applytransferDateOption('td');TDTMParams['showTDPopup']=true;" style="margin-left: 6px;">
          {{"business-dashboard.question.questionedit.transferdate" | translate}}
        </button>
      </div>
    </div>
  </div>
</div>
<nz-divider></nz-divider>
</div>

<nz-spin [nzSpinning]="loading">
  <div class="row" *ngIf="qDetail">
    <div class="col-md-6 border-right">
      <div class="row paddingT15 selection-vrsn marginbtm-15">
        <div class="col-md-6">
          {{"business-dashboard.question.editnoticeforquestion" | translate}}
        </div>
      </div>
      <form nz-form [formGroup]="validateForm" class="question-create" *ngIf="editableFields">
        <div>
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-4">
              {{ "business-dashboard.question.assembly" | translate }} :
            </div>
            <div class="col-md-2" *ngIf="assemblySession['assembly']">
              {{ assemblySession["assembly"].currentassemblyLabel }}
            </div>
            <div class="col-md-4">
              {{ "business-dashboard.question.session" | translate }} :
            </div>
            <div class="col-md-2" *ngIf="assemblySession['session']">
              <nz-form-item>
                <nz-form-control *ngIf="editableFields.sessionEdit; else viewSession">
                  <nz-select nzShowSearch nzAllowClear formControlName="sessionId"
                    (ngModelChange)="getQuestionDateListOnSession()">
                    <nz-option *ngFor="let session of assemblySession['session']" [nzLabel]="session.sessionId"
                      [nzValue]="session.id">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
                <ng-template #viewSession>
                  <span class="margnlft-10">
                    {{ assemblySession["session"].currentsessionLabel }}</span>
                </ng-template>
              </nz-form-item>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15" *ngIf="editableFields.clubbmla">
            <div class="col-md-4">
              {{ "business-dashboard.question.mlaName" | translate }} :
            </div>
            <div class="col-md-8 mla-tg">
              <nz-tag *ngFor="
                  let mla of qDetail.question.clubbingDetails;
                  let i = index
                " [nzMode]="
                  editableFields.clubbedMlaEdit && !mla.primaryMember
                    ? 'closeable'
                    : 'default'
                " (nzAfterClose)="removeClubbedMla(mla)" [ngClass]="{ first: mla.primaryMember }">
                {{ mla.memberName }}
              </nz-tag>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-4">
              {{ "business-dashboard.question.noticeno" | translate }} :
            </div>
            <div class="col-md-8">
              <div *ngFor="let noticeNo of qDetail.question.clubbingDetails">
                <span *ngIf=" noticeNo.noticeNumber.charAt(0) === 'T' else showNoticeNo">
                  <strong style="color: red;">T</strong>{{ noticeNo.noticeNumber.substring(1)}}
                </span>
                <ng-template #showNoticeNo>
                  <span #showNoticeNo>
                    {{ noticeNo.noticeNumber}}
                  </span>
                </ng-template>
              </div>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-4">
              {{ "business-dashboard.question.dateofreg" | translate }} :
            </div>
            <div class="col-md-8">
              {{ qDetail.question.registrationDate | date: "dd-MM-yyyy" }}
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-4">
              {{ "business-dashboard.question.questiondate" | translate }} :
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.questioncreate.placehldqdate'
                      | translate
                  }}">
                  <nz-select *ngIf="editableFields.questionDate; else viewquestionDate" nzRequired nzShowSearch
                    nzAllowClear nzPlaceHolder="{{
                      'business-dashboard.question.questioncreate.placehldqdate'
                        | translate
                    }}" formControlName="questionDate" (ngModelChange)="
                      _getExistingQuestionCount(); getDesignationListOnQdate()
                    ">
                    <nz-option *ngFor="let item of questionDate" nzLabel="{{ item | date: 'dd-MM-yyyy' }}"
                      nzValue="{{ item }}">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>
              <ng-template #viewquestionDate>
                {{
                  qDetail.question.qDate | date: "dd-MM-yyyy"
                }}</ng-template>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15" *ngIf="qDetail.question.type !== 'SHORT_NOTICE'">
            <div class="col-md-4">
              {{ "business-dashboard.question.ncategory" | translate }}
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.questioncreate.qcategory'
                      | translate
                  }}">
                  <nz-radio-group *ngIf="
                      editableFields.categoryEdit &&
                        qDetail.question.type !== 'SHORT_NOTICE';
                      else viewCategory
                    " nzName="radiogroup" formControlName="category" nzRequired>
                    <label [nzDisabled]="disableStarred" nz-radio nzValue="STARRED" (click)="changeQCategory()">{{
                        "business-dashboard.question.starred" | translate
                      }}</label>
                    <label nz-radio nzValue="UNSTARRED" (click)="changeQCategory()">{{
                        "business-dashboard.question.unstarred" | translate
                      }}</label>
                  </nz-radio-group>
                </nz-form-control>
              </nz-form-item>
              <ng-template #viewCategory>
                {{ qDetail.question.category }}</ng-template>
            </div>
            <div class="row" *ngIf="changeCategoryRule !== ''">
              <div class="col-md-11">
                <nz-alert *ngIf="changeCategoryReason" nzType="warning"
                  nzMessage='{{"business-dashboard.question.quecatchangasperfolldirec" | translate}}'
                  nzDescription="Direction: {{ changeCategoryRule }}" nzShowIcon>
                </nz-alert>
              </div>
            </div>
          </div>
          <div class="row paddingT15 arginbtm-15" *ngIf="
              qDetail.question &&
              qDetail.question.priority &&
              qDetail.question.type !== 'SHORT_NOTICE'
            ">
            <div class="col-md-4">
              {{ "business-dashboard.question.noticepriority" | translate }}
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.questioncreate.placehldnoticepriority'
                      | translate
                  }}">
                  <nz-select *ngIf="
                      editableFields.priorityEdit &&
                        qDetail.question.type !== 'SHORT_NOTICE';
                      else viewPriority
                    " nzPlaceHolder="{{
                      'business-dashboard.question.questioncreate.placehldnoticepriority'
                        | translate
                    }}" nzShowSearch nzAllowClear formControlName="priority">
                    <nz-option *ngFor="let p of priorityList" [nzLabel]="p" [nzValue]="p">{{ p }}</nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>
              <ng-template #viewPriority>
                {{ qDetail.question.priority }}</ng-template>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-4" *ngIf="editableFields.transferDate  else viewPortfolioLabel">
              <strong>{{ "business-dashboard.question.portfolio" | translate }} : </strong>
            </div>
            <ng-template #viewPortfolioLabel>
              <div class="col-md-4">
                {{ "business-dashboard.question.portfolio" | translate }} :
              </div>
            </ng-template>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.questioncreate.placehldportfolio'
                      | translate
                  }}">
                  <nz-select *ngIf="editableFields.transferDate; else viewPortfolio"
                    (ngModelChange)="bindMinisterSubject($event)" nzShowSearch nzAllowClear nzPlaceHolder="{{
                      'business-dashboard.question.questioncreate.placehldportfolio'
                        | translate
                    }}" formControlName="portfolio">
                    <nz-option *ngFor="let data of portfolio" [nzLabel]="data.name" [nzValue]="data"></nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>
              <ng-template #viewPortfolio>
                {{
                  qDetail.portfolio ? qDetail.portfolio.name : ""
                }}</ng-template>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-4">
              {{ "business-dashboard.question.ministersubject" | translate }} :
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.questioncreate.placehldministersubject'
                      | translate
                  }}">
                  <nz-select nzRequired nzShowSearch nzAllowClear nzPlaceHolder="{{
                      'business-dashboard.question.questioncreate.placehldministersubject'
                        | translate
                    }}" (ngModelChange)="bindMinisterSubSubject($event)" formControlName="ministerSubject">
                    <nz-option *ngFor="let item of ministerSubjects" [nzLabel]="item.title" [nzValue]="item">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>
              <ng-template #viewMinistersubject>
                {{
                  qDetail.ministerSubjects ? qDetail.ministerSubjects.title : ""
                }}</ng-template>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15" *ngIf="
              editableFields.subsubjectEdit ||
              qDetail?.question?.ministerSubSubjectName
            ">
            <div class="col-md-4">
              {{
                "business-dashboard.question.ministersubsubject" | translate
              }}:
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control *ngIf="editableFields.subsubjectEdit; else viewsubsubject" nzErrorTip="{{
                    'business-dashboard.question.selministersubsubject' | translate
                  }}">
                  <div class="row">
                    <div class="col-md-12">
                      <nz-select nzRequired nzShowSearch nzAllowClear nz-Input
                        nzPlaceHolder='{{"business-dashboard.question.selministersubsubject" | translate}}' formControlName="subSubjectId">
                        <nz-option *ngFor="let data of ministerSubSubject" [nzValue]="data.id" [nzLabel]="data.title">
                        </nz-option>
                      </nz-select>
                    </div>
                  </div>
                </nz-form-control>
                <ng-template #viewsubsubject>
                  {{
                    qDetail?.question?.ministerSubSubjectName
                      ? qDetail?.question?.ministerSubSubjectName
                      : ""
                  }}
                </ng-template>
              </nz-form-item>
            </div>
          </div>
          <!-- <div class="row paddingT15 marginbtm-15" *ngIf="
              editableFields.transferDate &&
              qDetail.question.type !== 'SHORT_NOTICE'
            ">
            <div class="col-md-4">
              <strong>{{ "business-dashboard.question.transferabledate" | translate }}</strong>
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.transferabledate' | translate
                  }}">
                  <nz-select nzRequired nzAllowClear nzShowSearch nzPlaceHolder="Select Transferable Date"
                    formControlName="transfarableDate" (ngModelChange)="transferDate($event)">
                    <nz-option *ngFor="let item of transfarableDate" [nzLabel]="item | date: 'dd-MM-yyyy'"
                      [nzValue]="item">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>
              <ng-template #viewquestionDate>
                {{
                  qDetail.question.questionDate | date: "dd-MM-yyyy"
                }}</ng-template>
            </div>
          </div> -->
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-4">
              {{ "business-dashboard.question.noticeheading" | translate }}
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.questioncreate.placehldnoticeheading'
                      | translate
                  }}">
                  <textarea *ngIf="
                      editableFields.noticeHeadingEdit;
                      else viewnoticeHeading
                    " nz-input [nzAutosize]="{ minRows: 1, maxRows: 6 }" formControlName="heading" nzRequired
                    class="ant-select-selection" minlength="{{ configurableParms['minTitleChar'] }}"
                    maxlength="{{ configurableParms['maxTitleChar'] }}" nzRequired
                    oninput="javascript: if (this.value.length==1 && this.value==' ') this.value = '';">
                  </textarea>
                </nz-form-control>
              </nz-form-item>
              <ng-template #viewnoticeHeading>
                {{ qDetail.question.heading }}</ng-template>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15" *ngIf="!editableFields.tagEdit && qDetail.question.tags.length > 0">
            <div class="col-md-4">
              {{"business-dashboard.question.tags" | translate}}
            </div>
            <div class="col-md-8">
              <nz-tag *ngFor="let tgs of qDetail.question.tags; let i = index">
                {{ tgs.tag }}
              </nz-tag>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15" *ngIf="editableFields.tagEdit && qDetail.question">
            <div class="col-md-4">
              {{"business-dashboard.question.tags" | translate}}
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="Enter Tags">
                  <nz-tag *ngFor="let tags of qDetail.question.tags; let i = index"
                    [nzMode]="editableFields.tagEdit ? 'closeable' : 'default'" (nzAfterClose)="_removeTag(tags)">
                    {{ _sliceTagName(tags.tag) }}
                  </nz-tag>
                  <nz-tag *ngIf="!showAddTag && editableFields.tagEdit" class="editable-tag" nzNoAnimation
                    (click)="_showAddTag()">
                    <i nz-icon nzType="plus"></i>
                    {{"business-dashboard.question.questionlist.newtag" | translate}}
                  </nz-tag>
                  <input oninput="javascript: if (this.value.length==1 && this.value==' ') this.value = '';" #tagInput
                    nz-input nzSize="small" *ngIf="showAddTag" type="text" formControlName="tags" style="width: 78px;"
                    (blur)="addTag()" (keydown.enter)="addTag()" maxlength="20" />
                </nz-form-control>
              </nz-form-item>
            </div>
          </div>
          <div class="row paddingT15 marginbtm-15">
            <div class="col-md-12">
              <div formArrayName="clauses">
                <ngx-sortable [items]="qClause.controls" (listSorted)="listSorted($event)" name="Clause List">
                  <ng-template let-d>
                    <nz-card class="marginbtm-15 pd0">
                      <div [formGroupName]="qClause.controls.indexOf(d)">
                        <nz-form-item>
                          <nz-form-control nzErrorTip="{{
                              'business-dashboard.question.questioncreate.enterclause'
                                | translate
                            }}">
                            <div class="row margnrtp-15">
                              <div class="col-auto pl5">
                                <nz-form-label>{{"business-dashboard.question.clause" | translate}}
                                  ({{
                                    upper[qClause.controls.indexOf(d)]
                                  }})</nz-form-label>
                              </div>
                              <div class="col-md-7" style="padding: 0px;">
                                <textarea #myText id="newText" *ngIf="
                                    editableFields.clauseEdit;
                                    else viewclause
                                  " nz-input placeholder="" (paste)="
                                    onPaste($event, qClause.controls.indexOf(d))
                                  " (keydown)="
                                    disableKey(
                                      myText.value,
                                      $event,
                                      qClause.controls.indexOf(d)
                                    )
                                  " (click)="onInput()" [nzAutosize]="{ minRows: 5, maxRows: 8 }"
                                  formControlName="clause"
                                  oninput="javascript: if (this.value.length==1 && this.value==' ') this.value = '';">
                                </textarea>
                                <ng-template #viewclause>
                                  {{
                                    d.value ? d.value.clause : ""
                                  }}</ng-template>
                              </div>



                              <div class="col-md-2 d-flex justify-content-end marginbtm-10">
                                <button nz-button nzType="default" nz-popconfirm nzCancelText="No" nzOkText="Yes"
                                  nzPopconfirmTitle='{{"business-dashboard.question.questioncreate.deletemsgclause" | translate}}' (nzOnConfirm)="
                                    deleteClause(qClause.controls.indexOf(d))
                                  " (nzOnCancel)="cancelDelete()" nzPopconfirmPlacement="bottomLeft">
                                  <i nz-icon nzType="delete" nzTheme="outline"></i>
                                </button>

                                <button nz-button nzType="primary" *ngIf="buttonlist.Disallow && d.value.id"
                                  nz-popconfirm nzCancelText="No" nzOkText="Yes"
                                  nzPopconfirmTitle='{{"business-dashboard.question.douwantdisallowthisclause" | translate}}' (nzOnConfirm)="
                                    DisallowClause(qClause.controls.indexOf(d))
                                  " nzPopconfirmPlacement="bottomLeft" style="margin-left: 6px;">
                                  {{"business-dashboard.question.questionlist.disallow" | translate}}
                                </button>
                              </div>
                            </div>
                          </nz-form-control>
                        </nz-form-item>
                      </div>
                    </nz-card>
                  </ng-template>
                </ngx-sortable>
              </div>
            </div>
            <div class="col-md-12 margnrtp-15">
              <button nz-button nzType="dashed" class="add-button d-flex align-items-center" (click)="addNewClause()">
                <i nz-icon nzType="plus"></i>
                {{"business-dashboard.question.questioncreate.addclause" | translate}}
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div class="col-md-6" *ngIf="v1.question">
      <div class="row paddingT15 selection-vrsn marginbtm-15">
        <div class="col-md-4">
          {{ "business-dashboard.question.versioning.version" | translate }}
        </div>
        <div class="col-md-8">
          <nz-select (ngModelChange)="getVersionDetailsById($event)" [(ngModel)]="selectedVersionV1">
            <nz-option *ngFor="let version of versionsCombo" nzCustomContent nzLabel="{{ version.ROLE }}"
              [nzValue]="version.id">
              <div class="row dropdown-option">
                <div class="col-md-12">
                  <div class="row">
                    <strong>{{ version.ROLE }}</strong>
                  </div>
                  <div class="row">
                    {{ version.cretationDate | date: "dd-MM-yyyy hh:mm a" }}
                  </div>
                </div>
              </div>
            </nz-option>
          </nz-select>
        </div>
      </div>
      <div>
        <div class="row paddingT15 marginbtm-15">
          <div class="col-md-4">
            {{ "business-dashboard.question.assembly" | translate }} :
          </div>
          <div class="col-md-2">
            <span>{{ v1.question.assemblyId }}</span>
          </div>
          <div class="col-md-4">
            {{ "business-dashboard.question.session" | translate }} :
          </div>
          <div class="col-md-2">
            <span>{{ v1.question.sessionId }}</span>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15">
          <div class="col-md-4">
            {{ "business-dashboard.question.mlaName" | translate }} :
          </div>
          <div class="col-md-8 mla-tg">
            <nz-tag *ngFor="let mla of v1.question.clubbingDetails; let i = index" [nzMode]="'default'"
              [ngClass]="{ first: mla.primaryMember }">
              {{ mla.memberName }}
            </nz-tag>
            <!-- <div
          class="row input-style"
          *ngFor="let ma of v1.question.clubbingDetails; let i = index"
        >
          <span>{{ ma.memberName }}</span>
        </div> -->
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15">
          <div class="col-md-4">
            {{ "business-dashboard.question.noticeno" | translate }} :
          </div>
          <div class="col-md-8">
            <div *ngFor="let ma of v1.question.clubbingDetails; let i = index">
              <span *ngIf="ma.noticeNumber.charAt(0) === 'T' else showNoticeNo">
                <strong style="color: red;">T</strong>{{ma.noticeNumber.substring(1)}}
              </span>
              <ng-template #showNoticeNo>
                <span #showNoticeNo>
                  {{ma.noticeNumber}}
                </span>
              </ng-template>
            </div>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15">
          <div class="col-md-4">
            {{ "business-dashboard.question.dateofreg" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.registrationDate }}</span>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15">
          <div class="col-md-4">
            {{ "business-dashboard.question.questiondate" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.questionDate }}</span>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15" *ngIf="v1.question.type !== 'SHORT_NOTICE'">
          <div class="col-md-4">
            {{ "business-dashboard.question.ncategory" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.category }}</span>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15 margntp-25"
          *ngIf="v1.question.priority && v1.question.type !== 'SHORT_NOTICE'">
          <div class="col-md-4">
            {{ "business-dashboard.question.noticepriority" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.priority }}</span>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15 margntp-25">
          <div class="col-md-4">
            {{ "business-dashboard.question.portfolio" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.portfolioName }}</span>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15 margntp-25">
          <div class="col-md-4">
            {{ "business-dashboard.question.ministersubject" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.subjectName }}</span>
          </div>
        </div>
        <div class="row paddingT15 marginbtm-15 margntp-25">
          <div class="col-md-4">
            {{ "business-dashboard.question.ministersubsubject" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.subSubjectName }}</span>
          </div>
        </div>
        <!-- <div class="row paddingT15 marginbtm-15" *ngIf="editableFields.transferDate">
          <div class="col-md-12">
            <div class="blank_block"></div>
          </div>
        </div> -->
        <div class="row paddingT15 marginbtm-15 margntp-25">
          <div class="col-md-4">
            {{ "business-dashboard.question.noticeheading" | translate }} :
          </div>
          <div class="col-md-8">
            <span>{{ v1.question.heading }}</span>
          </div>
        </div>
        <div class="row paddingT15 mb40 margntp-25">
          <div class="col-md-4">
            {{ "business-dashboard.question.versioning.tags" | translate }} :
          </div>
          <div class="col-md-8">
            <div class="row">
              <div class="col-auto tag-style" *ngFor="let tag of v1.question.tags; let i = index">
                <span>{{ tag.tag }}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="row paddingT15">
          <div class="col-md-12 marginbtm-25">
            <h5 style="line-height: 30px;">Clause List</h5>
          </div>
          <div class="col-md-12">
            <div class="width-100" *ngFor="let clause of v1.question.clauses; let i = index">
              <div class="col-md-12 clause-style">
                <div class="row">
                  <div class="col-md-4">{{ "Clause " + upper[i] }} :</div>
                  <div class="col-md-8">
                    <div>
                      <span class="word-break">{{ clause.clause }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</nz-spin>
<div class="">
  <nz-modal [(nzVisible)]="disallowRules" nzTitle='{{"business-dashboard.question.questionlist.rules" | translate}}' (nzOnCancel)="cancelRule()" (nzOnOk)="ruleSelected()">
    <div class="pading-all width-100">
      <div class="padding-15">
        <nz-table #rowdisallow [nzData]="ruleList" [nzPageSize]="5">
          <thead>
            <tr>
              <th></th>
              <th>{{"business-dashboard.question.ruleno" | translate }}</th>
              <th>{{"business-dashboard.question.description" | translate }}</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of rowdisallow.data">
              <td nzShowCheckbox [(nzChecked)]="data.checked" (nzCheckedChange)="checkedRule($event)"></td>
              <td>{{ data.code }}</td>
              <td>{{ data.englishDescription }}</td>
            </tr>
          </tbody>
        </nz-table>
      </div>
      <div class="row">
        <div class="col-md-2">
          <nz-form-label>
            {{"business-dashboard.question.reason" | translate}}
          </nz-form-label>
        </div>
        <div class="col-md-10">
          <input type="text" nzSize="large" nz-required nz-input [(ngModel)]="reason" name="reason" nz-input
            placeholder='{{"business-dashboard.question.typeyourreasonhere" | translate}}' />
        </div>
      </div>
    </div>
  </nz-modal>
</div>
<div>
  <nz-modal nzClosable="false" nzMaskClosable="false" [(nzVisible)]="ShowRules" nzTitle='{{"business-dashboard.question.rules&directions" | translate}}'
    (nzOnCancel)="cancelRuleSelection('true')" (nzOnOk)="applyRuleDirection()" nzClassName="pdngs">
    <nz-table #rowSelectionTable [nzData]="ruleList" [nzPageSize]="5">
      <thead>
        <tr>
          <th></th>
          <th>{{"business-dashboard.question.ruleno" | translate }}</th>
          <th>{{"business-dashboard.question.description" | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of rowSelectionTable.data">
          <td nzShowCheckbox [(nzChecked)]="data.checked" (nzCheckedChange)="checkedRule($event)"></td>
          <td>{{ data.code }}</td>
          <td>
            {{ data.englishDescription }}
          </td>
        </tr>
      </tbody>
    </nz-table>
    <div class="row">
      <div class="col-md-2">
        <nz-form-label>{{"business-dashboard.question.reason" | translate}}</nz-form-label>
      </div>
      <div class="col-md-10">
        <input type="text" nzSize="large" nz-input [(ngModel)]="reason" name="reason" nz-input
          placeholder='{{"business-dashboard.question.typeyourreasonhere" | translate}}' class="bg_inp" />
      </div>
    </div>
  </nz-modal>
</div>
<div class="">
  <nz-modal nzClosable="false" nzMaskClosable="false" [(nzVisible)]="showDirection" nzTitle='{{"business-dashboard.question.directions" | translate}}'
    (nzOnCancel)="cancelRuleSelection('true')" (nzOnOk)="applyRuleDirection()" nzClassName="pdngs">
    <div class="pading-all width-100">
      <div class="padding-15">
        <nz-table #rowDirectionTable [nzData]="directionList" [nzPageSize]="5">
          <thead>
            <tr>
              <th></th>
              <th>{{"business-dashboard.question.directionno" | translate}}</th>
              <th>{{"business-dashboard.question.description" | translate }}</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of rowDirectionTable.data">
              <td *ngIf="data.heading; else elseBlock" colspan="3">
            <tr>
              <td colspan="2">
                <b class="marginbtm-10 fl width-100">{{ data.heading }}</b>
              </td>
            </tr>
            <tr>
              <td nzShowCheckbox [(nzChecked)]="data.checked" width="50"></td>
              <td>{{ data.englishDescription }}</td>
            </tr>
            </td>
            <ng-template #elseBlock>
              <td nzShowCheckbox [(nzChecked)]="data.checked"></td>
              <td>{{ data.code }}</td>
              <td>{{ data.englishDescription }}</td>
            </ng-template>
            </tr>
          </tbody>
        </nz-table>
      </div>
    </div>
  </nz-modal>
</div>
<div class="">
  <nz-modal nzTitle='{{"business-dashboard.question.noticeinfo" | translate}}' [(nzVisible)]="showFileInfo" (nzOnCancel)="showFileInfoPopUp(false)"
    nzClassName="pdngs" [nzFooter]="null" [nzWidth]="'800'">
    <div class="width-100">
      <div class="input-group">
        <div class="row align-items-center width-100">
          <div class="col-md-2 align-items-center" *ngIf="activityFlowList && activityFlowList.length > 0">
            <span class="workflowhd">
              {{"business-dashboard.question.mainworkflow" | translate}}
            </span>
          </div>
          <div class="col-md-10 marginbtm-10 margnrtp-15">
            <div class="overflow">
              <nz-steps nzSize="small">
                <nz-step *ngFor="let data of activityFlowList"
                  [nzStatus]="data.reason == 'completed' ? 'finish' : 'process'"
                  [ngClass]="{ dropFlow: data.endWrkflow }" [nzTitle]="capitalize(data.owner)"></nz-step>
              </nz-steps>
            </div>
          </div>
        </div>
      </div>
      <div class="input-group" *ngIf="revokeFlowList && revokeFlowList.length > 0">
        <div class="row align-items-center width-100">
          <div class="col-md-2">
            <span class="workflowhd">
              {{"business-dashboard.question.revokeworkflow" | translate}}
            </span>
          </div>
          <div class="col-md-10 marginbtm-25 margnrtp-15">
            <div class="overflow">
              <nz-steps nzSize="small">
                <nz-step *ngFor="let data of revokeFlowList"
                  [nzStatus]="data.reason == 'completed' ? 'finish' : 'process'" [nzTitle]="data.owner"></nz-step>
              </nz-steps>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nz-modal>
</div>

<!-- custom note popup -->
<div class="custom_note" [ngClass]="{ shownote: shownotes }" *ngIf="qDetail">
  <div class="ant-drawer-header ant-drawer-header-no-title ng-star-inserted">
    <!---->
    <div class="ant-drawer-title ng-star-inserted">
      <!---->
      <!---->
      <div class="ng-star-inserted">{{"business-dashboard.question.notes" | translate}} &amp; {{"business-dashboard.question.questionlist.comments" | translate}}</div>
    </div>
    <!----><button aria-label="Close" class="ant-drawer-close ng-star-inserted" (click)="handleNotes(false)">
      <i nz-icon="" nztype="close" class="anticon anticon-close"></i>
    </button>
  </div>
  <div #scrollMe class="chat-main-body" [scrollTop]="scrollMe.scrollHeight">
    <nz-card *ngFor="let data of notesList; let i = index" class="mrgn-15">
      <div>
        <div class="input-group">
          <div class="row d-flex justify-content-between width-100">
            <div class="col-md-9">
              <div class="row">
                <div class="col-md-12">
                  {{ data?.owner?.details?.fullName }}
                </div>
                <div class="col-md-12">
                  <span class="font-w">
                    {{displayNoteOwnr(data)}}</span>
                </div>
              </div>
            </div>
            <div class="col-md-3 d-flex justify-content-end pr-0">
              <div nz-row hover>
                <button *ngIf="data.editNote" nz-button nzType="default" (click)="editNotes(i, data)">
                  {{"business-dashboard.question.edit" | translate}}
                </button>&nbsp;&nbsp;
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">
            <div>
              <!-- <span *ngIf="data.noteditable">
                <div *ngIf="!shortNoticeQuickOption">
                  <strong>
                    {{"business-dashboard.question.quickoptions" | translate}} :
                  </strong>
                  <nz-tag *ngFor="let tag of quickOptions" nzMode="checkable"
                    [nzChecked]="selectedTags.indexOf(tag.label) > -1"
                    (nzCheckedChange)="CheckforRules($event, tag, i)">
                    {{ tag.label }}
                  </nz-tag>
                </div>
                <div *ngIf="shortNoticeQuickOption">
                  <strong>{{"business-dashboard.question.quickoptions" | translate}} :</strong>
                  <nz-tag *ngFor="let tag of quickOption" nzMode="checkable"
                    [nzChecked]="selectedTags.indexOf(tag.label) > -1"
                    (nzCheckedChange)="CheckforRules($event, tag, i)">
                    {{ tag.label }}
                  </nz-tag>
                </div>
                <nz-input-group nzSearch nzSize="large" [nzAddOnAfter]="suffixButton">
                  <input type="text" nzSize="large" nz-input [(ngModel)]="editedNote" name="editedNote" nz-input
                    placeholder='{{"business-dashboard.question.typeyourcomments&notes" | translate}}' />
                </nz-input-group>
                <ng-template #suffixButton>
                  <button nzType="default" (click)="updateNotes(i, qDetail.question.id, data)" nz-button>
                    {{"business-dashboard.question.save" | translate}}
                  </button>
                </ng-template>
              </span> -->
              <span *ngIf="!data.noteditable"><b>{{ data.note }}</b></span>
              <div>
                <div class="d-flex justify-content-between mt-20 w-100">
                  <div class="col-md-5 pl0">
                    {{"business-dashboard.question.versioning.version" | translate}}
                    {{ data.questionVersion }}
                  </div>
                  <div class="col-md-7 d-flex justify-content-end pr0">
                    <div>
                      {{ data.createDate | date: "dd MMMM yyyy" }}
                    </div>
                    <div class="margnlft-15">
                      {{ data.createDate | date: "hh:mm a" }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nz-card>
  </div>
  <div class="chat-footer">
    <div class="txt-area-main">
      <div class="col" *ngIf="!shortNoticeQuickOption">
        <strong>{{"business-dashboard.question.quickoptions" | translate}} : </strong>
        <nz-tag nzMode="checkable" *ngFor="let tag of quickOptions; let i = index"
          [nzChecked]="selectedTags.indexOf(tag.label) > -1" (nzCheckedChange)="CheckforRules($event, tag, i)">
          {{ tag.label }}
        </nz-tag>
      </div>
      <div class="col" *ngIf="shortNoticeQuickOption">
        <strong>{{"business-dashboard.question.quickoptions" | translate}} :</strong>
        <nz-tag nzMode="checkable" *ngFor="let tag of quickOption; let i = index"
          [nzChecked]="selectedTags.indexOf(tag.label) > -1" (nzCheckedChange)="CheckforRules($event, tag, i)">
          {{ tag.label }}
        </nz-tag>
      </div>
    </div>
    <div>
      <div class="col">
        <div>
          <span>
            <nz-input-group nzSearch nzSize="large" [nzAddOnAfter]="suffixButton">
              <input type="text" nzSize="large" nz-input [(ngModel)]="noteGiven" name="noteGiven" nz-input
                placeholder='{{"business-dashboard.question.typeyourcomments&notes" | translate}}' />
            </nz-input-group>
            <ng-template #suffixButton>
              <button nzType="default" (click)="saveNotes(qDetail.question.id)" nz-button>
                {{"business-dashboard.question.save" | translate}}
              </button>
            </ng-template>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<div>
  <nz-modal [(nzVisible)]="TDTMParams['showTM']" (nzOnCancel)="cancelTDTM()" (nzOnOk)="selectTDTM()">
    <div class="width-100 pading-all">
      <nz-form-item>
        <div class="row margntp-25">
          <div class="col-md-4">
            <nz-form-label>{{ TDTMParams["TDTMLabel"] }}</nz-form-label>
          </div>

          <div class="col-md-8">
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear [(ngModel)]="TDTMParams['TMSelData']"
                (ngModelChange)="selTDTMSelData()">
                <nz-option *ngFor="let data of TDTMParams['TMData']" [nzLabel]="data" [nzValue]="data">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </div>
        </div>
      </nz-form-item>
    </div>
  </nz-modal>
</div>
<div>
  <nz-modal [(nzVisible)]="TDTMParams['showTD']" (nzOnCancel)="cancelTDTM()" (nzOnOk)="selectTDTM()">
    <div class="width-100 pading-all">
      <nz-form-item>
        <div class="row margntp-25">
          <div class="col-md-4">
            <nz-form-label>{{ TDTMParams["TDTMLabel"] }}</nz-form-label>
          </div>
          <div class="col-md-8">
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear [(ngModel)]="TDTMParams['TDSelData']"
                (ngModelChange)="selTDTMSelData()">
                <nz-option *ngFor="let data of TDTMParams['TDData']" [nzLabel]="data | date: 'dd-MM-yyyy'"
                  [nzValue]="data | date: 'dd-MM-yyyy'">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </div>
        </div>
      </nz-form-item>
    </div>
  </nz-modal>
</div>
<div>
  <nz-modal [(nzVisible)]="TDTMParams['showMinisterandDate']" (nzOnCancel)="cancelTDTM()" (nzOnOk)="selectTDTM()">
    <div class="width-100 pading-all">
      <nz-form-item>
        <div class="row margntp-25">
          <div class="col-md-4">
            <nz-form-label>
              {{"business-dashboard.question.selectquestiondate" | translate}}
            </nz-form-label>
          </div>
          <div class="col-md-8">
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear [(ngModel)]="TDTMParams['selDateData']"
                (ngModelChange)="getDesignationListByQDate($event)">
                <nz-option *ngFor="let data of TDTMParams['TDData']" [nzLabel]="data | date: 'dd-MM-yyyy'"
                  [nzValue]="data">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </div>
        </div>
        <div class="row margntp-25">
          <div class="col-md-4">
            <nz-form-label>
              {{"business-dashboard.question.selectminister" | translate}}
            </nz-form-label>
          </div>
          <div class="col-md-8">
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear [(ngModel)]="TDTMParams['selMinisterData']">
                <nz-option *ngFor="let data of TDTMParams['TMData']" [nzLabel]="data.name" [nzValue]="data">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </div>
        </div>
      </nz-form-item>
    </div>
  </nz-modal>
</div>

<div>
  <nz-modal [(nzVisible)]="TDTMParams['showTDPopup']" (nzOnCancel)="cancelTransferDate()" (nzOnOk)="transferDate()">
    <form nz-form [formGroup]="validateTDForm">
      <div class="width-100 pading-all">
          <div class="row margntp-25">
            <div class="col-md-4">
              <nz-form-label>
                {{ "business-dashboard.question.transferabledate" | translate }}
              </nz-form-label>
            </div>
            <div class="col-md-8">
              <nz-form-item>
                <nz-form-control nzErrorTip="{{
                         'business-dashboard.question.transferabledate' | translate
                       }}">
                  <nz-select nzRequired nzAllowClear nzShowSearch nzPlaceHolder='{{"business-dashboard.question.selecttransferabledate" | translate}}'
                    formControlName="transfarableDate" (ngModelChange)="getDesignationListByQDate($event)">
                    <nz-option *ngFor="let item of TDTMParams['TDData']" [nzLabel]="item | date: 'dd-MM-yyyy'"
                      [nzValue]="item">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>
            </div>
          </div>
            <div class="row margntp-25">
              <div class="col-md-4">
                <nz-form-label>
                  {{ "business-dashboard.question.portfolio" | translate }}
                </nz-form-label>
              </div>
              <div class="col-md-8">
                <nz-form-item>
                  <nz-form-control nzErrorTip="{{
                         'business-dashboard.question.questioncreate.placehldportfolio'
                           | translate
                       }}">
                    <nz-select (ngModelChange)="getMinisterSubject($event)" nzShowSearch nzAllowClear nzPlaceHolder="{{
                           'business-dashboard.question.questioncreate.placehldportfolio'
                             | translate
                         }}" formControlName="portfolio">
                      <nz-option *ngFor="let data of TDTMParams['TMData']" [nzLabel]="data.name" [nzValue]="data">
                      </nz-option>
                    </nz-select>
                  </nz-form-control>
                </nz-form-item>
              </div>
            </div>
            <div class="row margntp-25">
              <div class="col-md-4">
                <nz-form-label>
                  {{ "business-dashboard.question.ministersubject" | translate }}
                </nz-form-label>
              </div>
              <div class="col-md-8">
                <nz-form-item>
                  <nz-form-control nzErrorTip="{{
                    'business-dashboard.question.questioncreate.placehldministersubject'
                      | translate
                  }}">
                    <nz-select nzRequired nzShowSearch nzAllowClear nzPlaceHolder="{{
                      'business-dashboard.question.questioncreate.placehldministersubject'
                        | translate
                    }}" (ngModelChange)="getMinisterSubSubject($event ? $event.id : '')" formControlName="ministerSubject">
                      <nz-option *ngFor="let item of TDTMParams['ministerSubjects']" [nzLabel]="item.title"
                        [nzValue]="item">
                      </nz-option>
                    </nz-select>
                  </nz-form-control>
                </nz-form-item>
              </div>
            </div>
            <div class="row margntp-25">
              <div class="col-md-4">
                <nz-form-label>{{"business-dashboard.question.ministersubsubject" | translate}}</nz-form-label>
              </div>
              <div class="col-md-8">
                <nz-form-item>
                  <nz-form-control nzErrorTip="{{
                  'business-dashboard.question.selministersubsubject' | translate
                }}">
                    <nz-select nzRequired nzShowSearch nzAllowClear nzPlaceHolder="{{
                    'business-dashboard.question.selministersubsubject' | translate
                  }}" formControlName="subSubjectId">
                      <nz-option *ngFor="let item of TDTMParams['ministerSubSubjects']" [nzLabel]="item.title"
                        [nzValue]="item">
                      </nz-option>
                    </nz-select>
                  </nz-form-control>
                </nz-form-item>
              </div>
            </div>
      </div>
    </form>
  </nz-modal>
</div>